#!/usr/bin/env bash
# Script to audit domain and subdomain DNS records
# Usage: ./script_name domain [subdomain]

# Function to fetch and display DNS record information
fetch_dns_record() {
    local domain_name=$1
    local subdomain_name=$2

    # Fetching DNS records using dig
    local dns_output=$(dig +noall +answer "$subdomain_name.$domain_name")

    # Extracting and displaying relevant information
    if [[ $dns_output ]]; then
        local record_type=$(echo "$dns_output" | awk '{print $4}')
        local record_dest=$(echo "$dns_output" | awk '{print $5}')
        echo "The subdomain $subdomain_name is a $record_type record and points to $record_dest"
    else
        echo "No DNS record found for $subdomain_name.$domain_name"
    fi
}

# Main execution block
if [[ $# -eq 1 ]]; then
    # Default subdomains to check
    declare -a default_subdomains=("www" "lb-01" "web-01" "web-02")

    # Iterating over default subdomains
    for subdomain in "${default_subdomains[@]}"; do
        fetch_dns_record "$1" "$subdomain"
    done
elif [[ $# -eq 2 ]]; then
    # Checking specified subdomain
    fetch_dns_record "$1" "$2"
else
    echo "Invalid arguments. Usage: $0 domain [subdomain]"
    exit 1
fi
